<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.neu.jing.TaskDao">
    <resultMap type="task" id="taskResultMap">
        <id property="taskId" column="task_id"/>
        <result property="taskName" column="task_name"/>
        <result property="startTime" column="start_time"/>
        <result property="endTime" column="end_time"/>
        <result property="remark" column="remark"/>
        <result property="taskMajor" column="task_major"/>
        <result property="taskFinish" column="task_finish"/>
    </resultMap>
    <insert id="addTask" parameterType="Task">
        INSERT INTO task(task_name,end_time,remark,task_major,task_finish,type_id)
        VALUES (#{taskName}, #{endTime},#{remark},#{remark},#{taskMajor},#{taskFinish},#{typeId})
    </insert>

    <update id="updateTask" parameterType="Task">
        UPDATE task
        SET task_name = #{taskName}, end_time=#{endTime},remark=#{remark},task_major=#{taskMajor},task_finish=#{taskFinish},type_id=#{typeId}
        WHERE  task_id = #{taskId}
    </update>

    <delete id="deleteTask" parameterType="Task">
        delete from task where task_id=#{taskId}
    </delete>
    <!--两表联合??-->
    <select id="findAll" resultType="Task">
        SELECT task_name,start_time,end_time,remark,task_major,task_finish,type_name
        FROM task a LEFT JOIN  task_type b ON a.type_id = b.type_id
    </select>

    <select id="todayTask" resultMap="paperResultMap">
         select a.task_name,b.type_name
         from task a left join task_type b on a.type_id=b.type_id
         left join  today_task  c on a.task_id = c.task_id and c.time = #{time};
    </select>

    <!--    ?-->
<!--    <select id="addTodayTask">-->
<!--         select a.task_name,b.type_name c.task_id-->
<!--         from task a left join task_type b on a.type_id=b.type_id-->
<!--         left join  today_task  c on a.task_id = c.task_id and c.time = #{time};-->
<!--    </select>-->

    <update id="addMajorTask" parameterType="Task">
        update task
        set task_major = 1
        where task_id = #{task_id}
    </update>

    <update id="deleteTodayTask" parameterType="">
        update task
        set task = 1
        where task_id = #{task_id}
    </update>
    <update id="deleteMajorTask">
        UPDATE task
        SET task_major = 0
        where task_id = #{task_id}
    </update>
</mapper>
